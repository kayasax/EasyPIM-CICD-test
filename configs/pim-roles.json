{
  "version": "1.0",
  "configuration": {
    "tenant_id": "{{ .Env.AZURE_TENANT_ID }}",
    "subscription_id": "{{ .Env.AZURE_SUBSCRIPTION_ID }}",
    "dry_run": true,
    "log_level": "info"
  },
  "pim_groups": [
    {
      "group_name": "Development Environment Access",
      "group_id": "development-group",
      "description": "PIM roles for development environment CI/CD",
      "environment": "development",
      "roles": [
        {
          "role_definition_id": "21090545-7ca7-4776-b22c-e363652d74d2",
          "role_name": "Key Vault Reader",
          "scope": "/subscriptions/{{ .Env.AZURE_SUBSCRIPTION_ID }}/resourceGroups/rg-easypim-dev",
          "justification": "CI/CD pipeline needs to read secrets for deployment",
          "duration": "PT1H",
          "activation_maximum_duration": "PT8H"
        },
        {
          "role_definition_id": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
          "role_name": "Storage Blob Data Reader",
          "scope": "/subscriptions/{{ .Env.AZURE_SUBSCRIPTION_ID }}/resourceGroups/rg-easypim-dev",
          "justification": "Access storage for deployment artifacts",
          "duration": "PT1H",
          "activation_maximum_duration": "PT8H"
        }
      ]
    },
    {
      "group_name": "Staging Environment Access",
      "group_id": "staging-group",
      "description": "PIM roles for staging environment CI/CD",
      "environment": "staging",
      "roles": [
        {
          "role_definition_id": "21090545-7ca7-4776-b22c-e363652d74d2",
          "role_name": "Key Vault Reader",
          "scope": "/subscriptions/{{ .Env.AZURE_SUBSCRIPTION_ID }}/resourceGroups/rg-easypim-staging",
          "justification": "CI/CD pipeline needs to read secrets for staging deployment",
          "duration": "PT2H",
          "activation_maximum_duration": "PT4H"
        },
        {
          "role_definition_id": "ba92f5b4-2d11-453d-a403-e96b0029c9fe",
          "role_name": "Storage Blob Data Contributor",
          "scope": "/subscriptions/{{ .Env.AZURE_SUBSCRIPTION_ID }}/resourceGroups/rg-easypim-staging",
          "justification": "Upload deployment artifacts to staging storage",
          "duration": "PT2H",
          "activation_maximum_duration": "PT4H"
        },
        {
          "role_definition_id": "de139f84-1756-47ae-9be6-808fbbe84772",
          "role_name": "Website Contributor",
          "scope": "/subscriptions/{{ .Env.AZURE_SUBSCRIPTION_ID }}/resourceGroups/rg-easypim-staging",
          "justification": "Deploy to staging web apps",
          "duration": "PT2H",
          "activation_maximum_duration": "PT4H"
        }
      ]
    }
  ],
  "notification_settings": {
    "email_notifications": false,
    "teams_webhook": null,
    "audit_log_enabled": true
  },
  "security_settings": {
    "require_mfa": true,
    "require_justification": true,
    "require_approval": {
      "development": false,
      "staging": false,
      "production": true
    },
    "allowed_activation_duration": {
      "minimum": "PT30M",
      "maximum": "PT8H",
      "default": "PT1H"
    }
  }
}
